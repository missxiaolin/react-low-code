import{s as l,w as h,i as f,u as s,a as g,d as T,b as D,c as I}from"./useDragDropManager-DKbTUi75.js";import{i as p}from"./index-BGwl3vz8.js";let i=!1;class m{receiveHandlerId(t){this.targetId=t}getHandlerId(){return this.targetId}subscribeToStateChange(t,e){return this.internalMonitor.subscribeToStateChange(t,e)}canDrop(){if(!this.targetId)return!1;p(!i,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return i=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{i=!1}}isOver(t){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,t):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(t){this.targetId=null,this.internalMonitor=t.getMonitor()}}class C{get connectTarget(){return this.dropTarget}reconnect(){const t=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();t&&this.disconnectDropTarget();const e=this.dropTarget;if(this.handlerId){if(!e){this.lastConnectedDropTarget=e;return}t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=e,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,e,this.dropTargetOptions))}}receiveHandlerId(t){t!==this.handlerId&&(this.handlerId=t,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(t){this.dropTargetOptionsInternal=t}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!l(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(t){this.hooks=h({dropTarget:(e,n)=>{this.clearDropTarget(),this.dropTargetOptions=n,f(e)?this.dropTargetRef=e:this.dropTargetNode=e,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=t}}const O=window.React.useMemo;function M(r){return O(()=>r.hooks.dropTarget(),[r])}const b=window.React.useMemo;function w(r){const t=s(),e=b(()=>new C(t.getBackend()),[t]);return g(()=>(e.dropTargetOptions=r||null,e.reconnect(),()=>e.disconnectDropTarget()),[r]),e}const R=window.React.useMemo;function v(){const r=s();return R(()=>new m(r),[r])}const y=window.React.useMemo;function H(r){const{accept:t}=r;return y(()=>(p(r.accept!=null,"accept must be defined"),Array.isArray(t)?t:[t]),[t])}class S{canDrop(){const t=this.spec,e=this.monitor;return t.canDrop?t.canDrop(e.getItem(),e):!0}hover(){const t=this.spec,e=this.monitor;t.hover&&t.hover(e.getItem(),e)}drop(){const t=this.spec,e=this.monitor;if(t.drop)return t.drop(e.getItem(),e)}constructor(t,e){this.spec=t,this.monitor=e}}const k=window.React.useEffect,E=window.React.useMemo;function $(r,t){const e=E(()=>new S(r,t),[t]);return k(()=>{e.spec=r},[r]),e}function A(r,t,e){const n=s(),o=$(r,t),a=H(r);g(function(){const[d,u]=T(a,o,n);return t.receiveHandlerId(d),e.receiveHandlerId(d),u},[n,t,o,e,a.map(c=>c.toString()).join("|")])}function j(r,t){const e=D(r,t),n=v(),o=w(e.options);return A(e,n,o),[I(e.collect,n,o),M(o)]}export{j as u};
