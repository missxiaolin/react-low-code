import{u as g,j as e,m as I}from"./index-CISSGvlG.js";import{l as k,F as C}from"./index-Cd8mrToj.js";const S=window.antd.Modal,r=window.antd.Form,p=window.antd.Input,i=window.antd.Radio,B=window.antd.InputNumber,L=window.antd.Switch,O=window.React.useImperativeHandle,x=window.React.useState,N=window.React.forwardRef,T=window.React.useRef,$=(d,u)=>{const[h,c]=x(!1),[m,w]=x("add"),[s,t]=x("string"),a=T(null),[o]=r.useForm(),{theme:v,addVariable:y,editVariable:R}=g(n=>n);k.config({paths:{vs:`${window.location.origin}/static/monaco-editor/min/vs`}}),O(u,()=>({open(n,l){n==="edit"&&(l.type==="array"||l.type==="object"?o.setFieldsValue({...l,defaultValue:JSON.stringify(l.defaultValue,null,4)}):o.setFieldsValue(l),t(l.type)),w(n),c(!0)}}));const V=n=>{t(n)},F=()=>{o.validateFields().then(()=>{var l;const n=o.getFieldsValue();if(s==="array"||s==="object"){const b=(l=a.current)==null?void 0:l.getValue();if(b)try{n.defaultValue=JSON.parse(b)}catch{I.error("请输入正确的json数据");return}}m==="add"?y(n):R(n),f()})},f=()=>{o.resetFields(),c(!1),t("string")};return e.jsx(S,{title:"添加变量",open:h,width:650,onOk:F,onCancel:f,okText:"提交",cancelText:"取消",children:e.jsxs(r,{form:o,labelCol:{span:6},wrapperCol:{span:16},initialValues:{type:"string"},children:[e.jsx(r.Item,{label:"变量名称",name:"name",rules:[{required:!0,message:"请输入变量名称"},{pattern:/^[a-zA-Z]\w{0,19}$/,message:"请输入正确的变量名称"}],children:e.jsx(p,{placeholder:"请输入变量名称，以字母开头，支持大小写、下划线",maxLength:20,showCount:!0})}),e.jsx(r.Item,{label:"变量类型",name:"type",rules:[{required:!0,message:"请选择变量类型"}],children:e.jsxs(i.Group,{buttonStyle:"solid",onChange:n=>V(n.target.value),children:[e.jsx(i.Button,{value:"string",children:"字符串"}),e.jsx(i.Button,{value:"number",children:"数字"}),e.jsx(i.Button,{value:"boolean",children:"布尔"}),e.jsx(i.Button,{value:"array",children:"数组"}),e.jsx(i.Button,{value:"object",children:"对象"})]})}),e.jsxs(r.Item,{label:"变量默认值",name:"defaultValue",rules:[{required:!0,message:"请输入变量值"}],children:[s==="string"&&e.jsx(p,{placeholder:"请输入变量值"}),s==="number"&&e.jsx(B,{placeholder:"请输入变量值",style:{width:"100%"}}),s==="boolean"&&e.jsx(L,{}),(s==="array"||s==="object")&&e.jsx(C,{height:"250px",language:"json",theme:v==="dark"?"vs-dark":"vs-light",options:{lineNumbers:"on",minimap:{enabled:!1}},onMount:n=>a.current=n})]}),e.jsx(r.Item,{label:"变量说明",name:"remark",children:e.jsx(p,{placeholder:"请输入变量说明",maxLength:20,showCount:!0})})]})})},M=N($),q=window.React.useRef,D=window.antd.Button,P=window.antd.Flex,j=window.antd.List,z=window.icons.PlusOutlined,J=()=>{const d=q(),{page:u,removeVariable:h}=g(t=>t),{variables:c}=u,m=()=>{var t;(t=d.current)==null||t.open("add")},w=(t,a)=>{var o;t.preventDefault(),(o=d.current)==null||o.open("edit",a)},s=(t,a)=>{t.preventDefault(),h(a)};return e.jsxs(e.Fragment,{children:[e.jsx(P,{justify:"space-between",align:"center",style:{borderBottom:"1px solid var(--l-theme-card-border-color)"},children:e.jsx(D,{type:"link",icon:e.jsx(z,{}),onClick:()=>m(),children:"新增"})}),e.jsx(j,{style:{height:"calc(100vh - 150px)",overflowY:"auto"},itemLayout:"horizontal",dataSource:c,renderItem:t=>e.jsx(j.Item,{actions:[e.jsx("a",{onClick:a=>w(a,t),children:"修改"}),e.jsx("a",{onClick:a=>s(a,t.name),children:"删除"})],children:e.jsx(j.Item.Meta,{title:`${t.name}`,description:t.remark})})}),e.jsx(M,{ref:d})]})};export{J as default};
