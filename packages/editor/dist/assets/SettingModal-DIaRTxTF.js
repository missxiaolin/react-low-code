import{j as e,u as T,U as B}from"./index-CISSGvlG.js";import{V as k}from"./VariableBind-BSOFLFce.js";const R=window.icons.MinusCircleOutlined,E=window.icons.PlusOutlined,n=window.antd.Form,t=window.antd.Radio,c=window.antd.Input,O=window.antd.Switch,g=window.antd.Space,P=function(){return e.jsxs(e.Fragment,{children:[e.jsx(n.Item,{label:"接口ID",name:"id",hidden:!0,children:e.jsx(c,{})}),e.jsx(n.Item,{label:"接口名称",name:"name",rules:[{required:!0}],children:e.jsx(c,{placeholder:"请输入接口中文名称，eg: 用户列表",maxLength:20,showCount:!0})}),e.jsx(n.Item,{label:"请求方式",name:"method",children:e.jsxs(t.Group,{buttonStyle:"solid",children:[e.jsx(t.Button,{value:"GET",children:"GET"}),e.jsx(t.Button,{value:"POST",children:"POST"}),e.jsx(t.Button,{value:"PUT",children:"PUT"}),e.jsx(t.Button,{value:"PATCH",children:"PATCH"}),e.jsx(t.Button,{value:"DELETE",children:"DELETE"})]})}),e.jsx(n.Item,{label:"接口地址",extra:"支持模板语法：${id}，前提是事件流中有该字段。",children:e.jsx(g,{direction:"vertical",style:{width:"100%"},children:e.jsx(n.Item,{label:"API地址",name:"stgApi",noStyle:!0,rules:[{required:!0}],children:e.jsx(c,{prefix:"api：",placeholder:"http://www.missxiaolin.com/api/user"})})})}),e.jsx(n.Item,{label:"数据格式",name:"contentType",children:e.jsxs(t.Group,{buttonStyle:"solid",children:[e.jsx(t.Button,{value:"application/json",children:"JSON"}),e.jsx(t.Button,{value:"multipart/form-data",children:"FormData"}),e.jsx(t.Button,{value:"application/x-www-form-urlencoded",children:"Form"})]})}),e.jsx(n.Item,{label:"发送参数",children:e.jsx(n.List,{name:"params",children:(l,{add:m,remove:x})=>e.jsx(e.Fragment,{children:l.map(({name:r},o)=>e.jsxs(g,{align:"baseline",style:{marginBottom:l.length===o+1?0:10,alignItems:"center"},children:[e.jsx(n.Item,{name:[r,"key"],noStyle:!0,children:e.jsx(c,{placeholder:"请输入参数名"})}),e.jsx(n.Item,{name:[r,"value"],noStyle:!0,children:e.jsx(k,{placeholder:"请输入参数值"})}),e.jsx(E,{onClick:()=>m({key:"",value:""})}),o>0&&e.jsx(R,{onClick:()=>{x(r)}})]},`header-${o}`))})})}),e.jsx(n.Item,{label:"参数替换",name:"replaceData",tooltip:e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"1. 默认会把事件流参数和自定义参数合并；"}),e.jsx("p",{children:"2. 覆盖参数是事件流中上下文的参数覆盖自定义参数；"}),e.jsxs("p",{children:["3. 保留参数为只取自定义参数，参数支持模板语法：","${id}","。"]})]}),children:e.jsxs(t.Group,{buttonStyle:"solid",children:[e.jsx(t.Button,{value:"merge",children:"合并参数"}),e.jsx(t.Button,{value:"cover",children:"覆盖参数"}),e.jsx(t.Button,{value:"reserve",children:"保留参数"})]})}),e.jsx(n.Item,{label:"开启代理",name:"isCors",extra:"开启接口代理对解决跨域问题很有用",children:e.jsx(O,{})})]})},d=window.antd.Form,h=window.antd.Input,L=window.antd.InputNumber,V=window.icons.InfoCircleOutlined,$=function(){return e.jsxs(e.Fragment,{children:[e.jsxs("p",{style:{lineHeight:"35px",color:"#5c5c5c",marginLeft:"70px",marginBottom:"10px"},children:[e.jsx(V,{}),e.jsxs("span",{style:{marginLeft:5},children:["用来定义接口返回结构，推荐结构：","{ code: 0, data: {}, msg: '' }"]})]}),e.jsx(d.Item,{label:"业务码",extra:"接口返回业务状态码，默认是：code",name:["result","code"],children:e.jsx(h,{placeholder:"默认为：code",maxLength:15,showCount:!0})}),e.jsx(d.Item,{label:"成功值",extra:"接口返回成功时对应的状态码值，默认是：0",name:["result","codeValue"],children:e.jsx(L,{placeholder:"默认为：0"})}),e.jsx(d.Item,{label:"结果字段",extra:"接口返回结果字段，默认是：data",name:["result","data"],children:e.jsx(h,{placeholder:"默认为：data",maxLength:15,showCount:!0})}),e.jsx(d.Item,{label:"报错字段",extra:"接口返回报错字段，默认是：msg",name:["result","msg"],children:e.jsx(h,{placeholder:"默认为：msg",maxLength:15,showCount:!0})})]})},u=window.antd.Form,I=window.antd.Input,f=window.antd.Switch,A=function(){return e.jsxs(e.Fragment,{children:[e.jsx(u.Item,{label:"默认成功提示",name:["tips","success"],children:e.jsx(I,{placeholder:"默认不提示",maxLength:50,showCount:!0})}),e.jsx(u.Item,{label:"默认失败提示",name:["tips","fail"],children:e.jsx(I,{placeholder:"默认不提示",maxLength:50,showCount:!0})}),e.jsx(u.Item,{label:"接口成功提示",name:["tips","isSuccess"],valuePropName:"checked",extra:"开启接口成功提示后，会优先使用接口返回成功信息。",children:e.jsx(f,{})}),e.jsx(u.Item,{label:"接口报错提示",name:["tips","isError"],valuePropName:"checked",extra:"开启接口报错提示后，会优先使用接口返回错误信息。",children:e.jsx(f,{})})]})},D=window.React.forwardRef,M=window.React.useImperativeHandle,G=window.React.useState,b=window.antd.Form,H=window.antd.Modal,N=window.antd.Tabs,U=({update:l},m)=>{const{page:x,addApi:r,updateApi:o}=T(a=>a),{apis:v}=x.apis||{},[s]=b.useForm(),[S,p]=G(!1),j={method:"GET",url:"",sourceType:"json",params:[{key:"",value:""}],contentType:"application/json",replaceData:"merge",isCors:!0,result:{code:"code",data:"data",msg:"msg",codeValue:0},tips:{success:"请求成功",fail:"请求失败",isSuccess:!0,isError:!0}};M(m,()=>({showModal:a=>{const i=a?v[a]:{};a?s.setFieldsValue({...i}):s.setFieldsValue({...j,...i}),p(!0)}}));const F=[{key:"base-set",label:"接口设置",forceRender:!0,children:e.jsx(P,{})},{key:"structure",label:"返回结构设置",forceRender:!0,children:e.jsx($,{})},{key:"tips",label:"消息提示设置",forceRender:!0,children:e.jsx(A,{})}];async function y(){if(!await s.validateFields())return;const i=s.getFieldsValue();if(i.id)o(s.getFieldsValue());else{const C=B();r({...j,...s.getFieldsValue(),id:C})}l==null||l(i.id),w()}function w(){p(!1),s.resetFields()}return e.jsx(H,{width:"800px",okText:"确认",cancelText:"取消",title:"接口配置",open:S,onOk:y,onCancel:w,children:e.jsx(b,{form:s,labelCol:{span:4},wrapperCol:{span:19},style:{maxWidth:800},autoComplete:"off",children:e.jsx(N,{defaultActiveKey:"1",items:F})})})},K=D(U);export{K as S};
